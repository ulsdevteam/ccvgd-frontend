<div class="flexcontainer">
    <!-- <div class="container1"> -->
    <mat-card class="container1">
        <p class="select-headers">Select Villages-选择村庄 </p>
            <div>
            <!-- <mat-card-title>Select Villages-选择村庄 </mat-card-title> -->
            <div class="geologyDropdownList">
                <mat-form-field>
                    <mat-label>Province 省</mat-label>
                    <mat-select [(ngModel)]="provinceSearch" (ngModelChange)="getCityFromProvince($event)">
                        <mat-option>None</mat-option>
                        <mat-option *ngFor="let province of provinceList" [value]="province">
                            {{ province }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <!-- <p>Selected value: {{ provinceSearch }}</p> -->

                <mat-form-field>
                    <mat-label>City 市</mat-label>
                    <mat-select [(ngModel)]="citySearch" (ngModelChange)="getCountyFromCityProvince($event)">
                        <mat-option>None</mat-option>
                        <mat-option *ngFor="let city of cityList" [value]="city">
                            {{ city }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>County 县</mat-label>
                    <mat-select [(ngModel)]="countySearch" (ngModelChange)="onSelectCounty($event)">
                        <mat-option>None</mat-option>
                        <mat-option *ngFor="let county of countyList" [value]="county">
                            {{ county }}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>

            <mat-form-field class="any-input-field" appearance="fill">
                <!-- <mat-icon aria-hidden="false" aria-label="Example home icon">search</mat-icon> -->
                <mat-label><i class="fas fa-search"></i>Search Any Village Here</mat-label>
                <input matInput type="text" [(ngModel)]="search_value" (ngModelChange)="handleSearchInput($event)">
                <button *ngIf="search_value" matSuffix mat-icon-button aria-label="Clear" (click)="clearSearchValue()">
                  <mat-icon>close</mat-icon>
                </button>
              </mat-form-field>

        </div>

        <div class="title">
            <label>选择</label>
            <label>村庄名字</label>
            <label>省</label>
            <label>市</label>
            <label>县</label>
        </div>

        <div>
            <mat-checkbox class="selectall" (change)="checkUncheckAll()" [(ngModel)]="masterSelected">选择所有-Select All</mat-checkbox>
        </div>
        <div class="villageselectionlist">

            <mat-card-content class="village-Content">
                <table class="villagetable" mat-table [dataSource]="allVillageData">
                    <!--  checkbox column  -->
                    <ng-container matColumnDef="isSelected">
                        <th mat-header-cell *matHeaderCellDef>选择</th>
                        <mat-cell *matCellDef="let element">
                            <mat-checkbox style="margin-top: 100%;" (change)="isAllCheckBoxSelected($event,element)" [checked]="masterSelected"></mat-checkbox>
                        </mat-cell>
                    </ng-container>
                    <!-- Provice Column -->
                    <ng-container matColumnDef="village_name">
                        <th mat-header-cell *matHeaderCellDef>村庄名字</th>
                        <td mat-cell *matCellDef="let element">{{ element.name }}</td>
                    </ng-container>

                    <!-- Name Column -->
                    <ng-container matColumnDef="province">
                        <th mat-header-cell *matHeaderCellDef>省</th>
                        <td mat-cell *matCellDef="let element">{{ element.province }}</td>
                    </ng-container>

                    <!-- Weight Column -->
                    <ng-container matColumnDef="city">
                        <th mat-header-cell *matHeaderCellDef>市</th>
                        <td mat-cell *matCellDef="let element">{{ element.city }}</td>
                        <!-- <button>hallo</button> -->
                    </ng-container>

                    <!-- Symbol Column -->
                    <ng-container matColumnDef="county">
                        <th mat-header-cell *matHeaderCellDef>县</th>
                        <td mat-cell *matCellDef="let element">{{ element.county }}</td>
                    </ng-container>
                    <tr mat-row class="selectList" *matRowDef="let row; columns: displayedColumns;"
                    ></tr>
                </table>
            </mat-card-content>
        </div>

        <mat-paginator [length]="length"
               [pageSize]="pageSize"
               [pageSizeOptions]="pageSizeOptions"
               (page)="pageEvent = getServerData($event)"
               aria-label="Select page">
        </mat-paginator>

        <div class="villageselected">已选村庄-Selected Villages</div>

        <mat-card-actions class="villageselectedlist">


            <!-- <div class="villageselectedlist"> -->
            <mat-list *ngFor="let checkedItem of multiVillages_checkedList" style="max-height: 100px;">
                <!-- <app-dialog [okIsClick]="okIsClick($event)"></app-dialog> -->
                <mat-list-item>
                    <button mat-mini-fab color="accent" aria-label="Example icon button with a filter list icon">
                        <mat-icon aria-hidden="false" aria-label="Example home icon" (click)="deleteVillage($event, checkedItem)">delete</mat-icon>
                    </button> {{ checkedItem.village_name }} {{ checkedItem.province }} {{ checkedItem.city }} {{ checkedItem.county }}
                </mat-list-item>
                <mat-divider></mat-divider>
            </mat-list>
            <!-- </div> -->

        </mat-card-actions>

    </mat-card>
    <!-- </div> -->

    <mat-card class="container2">
        <p class="select-headers">选择主题-Select Topics</p>
        <mat-card *ngIf="topicHasYearSelection" style="background-color:rgb(129, 201, 195)">{{topicHasYearSelection}} has Year Data</mat-card>
        <div class="topics">

            <mat-tab-group animationDuration="0ms" (selectedTabChange)="tabChanged($event)" #tabGroup>
                <mat-tab label="{{ item }}" *ngFor="let item of displayedMiddleTabs">

                    <mat-card *ngIf="noCategoryData" class="notes">{{noCategoryNote}}</mat-card>

                    <div class="economy">

                            
                        <div *ngIf="isNamesTab">

                            <div class="table">

                                <mat-card class="row" *ngFor="let item of showAllNamesDataListUnique" style="margin: 10%;">
                                    <span class="cell" style="margin: 10%;">{{ item.name }} </span>
                                    <span class="cell">{{ item.fiveLastNames }}</span>
                                    <span class="cell">{{ item.num }}</span>
                                </mat-card>
                            </div>

                        </div>

                        <div class="category">


                            <div class="left">


                                <!-- <button (click)="selectAll()">selectAll</button> -->
                                
                                <mat-selection-list #list1 [(ngModel)]="category1_Option" (ngModelChange)="category1Selection($event)">
                                    <ng-container>
                                        <mat-list-option class="selectList" *ngFor="let category1 of category1Set" checkboxPosition="before" style="font-size: 14px;" [value]="category1">
                                            {{category1}}
                                        </mat-list-option>
                                    </ng-container>
                                </mat-selection-list>
                            </div>

                            <div class="twitter-like">
                                <mat-spinner class="background" 
                                    mode="indeterminate" 
                                    value="100"
                                    *ngIf="pageIsLoading"
                                    [diameter]="70"
                                    >
                                </mat-spinner>
                                </div>
                            <!-- <p *ngIf="pageIsLoading">Page is loading, please wait ☺️ ... </p> -->

                            <!-- <p>
                                Options selected: {{list1.selectedOptions.selected.length}}
                            </p>

                            <p>
                                Option selected: {{list1.selectedOptions.selected[0]?.value}}
                            </p> -->


                            <div class="middle">
                                <!-- 类别 -->
                                <!-- <p>{{ item }} 下类别</p> -->
                                <mat-selection-list #list2 [(ngModel)]="category2_Option" (ngModelChange)="category2Selection($event)">
                                    <ng-container>
                                        <mat-list-option class="selectList" *ngFor="let item of category2Res" 
                                        checkboxPosition="before" 
                                        style="font-size: 14px"
                                        [selected]="item.isSelected"
                                        >
                                            {{ item.category2 }}
                                        </mat-list-option>
                                    </ng-container>
                                </mat-selection-list>



                            </div>

                            <div class="right">
                                <mat-selection-list #list3 [(ngModel)]="category3_Option">
                                    <ng-container>
                                        <mat-list-option class="selectList" *ngFor="let item of category3Set" checkboxPosition="before" style="font-size: 14px">
                                            {{ item }}
                                        </mat-list-option>
                                    </ng-container>
                                </mat-selection-list>
                            </div>

                        </div>
                    </div>
                </mat-tab>
            </mat-tab-group>
        </div>
        <!-- </mat-card-header> -->

        <div class="topicselectedlist">
            <div class="topic-selected-header">已选主题-Selected Topics</div>


            <div *ngFor="let eachList of displayTopicCategory">
            <mat-card class="example-card">
                <mat-card-title-group>
                  <mat-card-subtitle>{{ eachList.selectedTopic }}下 -- 子类1</mat-card-subtitle>
                  <!-- <mat-card-subtitle>{{selectedCategoriesDisplay}}</mat-card-subtitle> -->
                  <mat-list *ngFor="let item of eachList.category1List">
                    <mat-list-item style="font-size: 15px; padding: 0%; margin: 0%;">
                        {{ item }}
                    </mat-list-item>
                </mat-list>
                </mat-card-title-group>
                <mat-card-content>
                </mat-card-content>
              </mat-card>
            </div>



            <!-- <div *ngFor="let eachList of displayTopicCategory">
                <p>{{ eachList.selectedTopic }}下 -- 子类1</p>
                <mat-list *ngFor="let item of eachList.category1List">
                    <mat-list-item style="font-size: 15px; padding: 0%; margin: 0%;">
                        {{ item }}
                    </mat-list-item>
                </mat-list>
            </div> -->

        </div>
    </mat-card>


    <!-- year select field -->

    <mat-card class="container3">
        <p class="select-headers">选择时间-Select Time</p>

        <div class="yearrangeselect">年段-Year Range</div>
        <div class="yearrange">

            <mat-form-field class="example-form-field" appearance="fill" [matTooltip]="tooltip_start_year">
                <mat-label>输入开始年份， 例如1949</mat-label>
                <input matInput type="text" [(ngModel)]="startYearInput" [disabled]="closeYearRange">
                <button *ngIf="startYearInput" matSuffix mat-icon-button aria-label="Clear" (click)="startYearInput=''">
                  <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>
            至
            <mat-form-field class="example-form-field" appearance="fill" [matTooltip]="tooltip_end_year">
                <mat-label>输入结束年份， 晚于开始年份</mat-label>
                <input matInput type="text" [(ngModel)]="endYearInput" [disabled]="closeYearRange">
                <button *ngIf="endYearInput" matSuffix mat-icon-button aria-label="Clear" (click)="endYearInput=''">
                  <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>

            <button mat-raised-button color="primary" class="addYear" (click)="onPostInputYear()">
        添加 - Add
      </button>


            <div class="year-selected-header"> 单年和多年不能一起选</div>
            <!-- <p>单年和多年不能一起选</p> -->
            <!-- <div class="yearselectedlist" #myYearDiv>
                <div class="year-range-selected-header"> 已选年段-Selected Year Range</div>
                <p>{{displayYearRange}}</p>
            </div> -->
        </div>



        <div class="yearselect">年份-Year</div>
        <mat-card *ngIf="closeYearRange && closeSingleYear" class="notes">Please search directly. "Select Time" is not applicable for this topic.</mat-card>
        <div class="singleyear">
            <div class="yearselectionlist">
                <mat-selection-list #listSingleYear>
                    <ng-container *ngFor="let item of topicYear">
                        <div *ngFor="let eachYear of item.total_year_only">
                            <mat-list-option #option [disabled]="closeSingleYear" checkboxPosition="before" style="font-size: 14px;" (click)="checkboxYear($event, eachYear, option.selected)">
                                {{eachYear}}
                            </mat-list-option>
                        </div>
                    </ng-container>
                </mat-selection-list>

            </div>
            <div class="yearselectedlist" >
                <div class="year-selected-header"> 已选年份-Selected Single Year Or Year Range</div>
                <!-- <mat-card *ngIf="closeYearRange && closeSingleYear" class="notes">Please search directly. "Select Time" is not applicable for this topic.</mat-card> -->
                <p *ngIf="closeYearRange">已选single-year - 数量{{listSingleYear.selectedOptions.selected.length}}</p>

                <div *ngIf="!closeYearRange">
                    <p>已选年段</p>
                    <p>{{displayYearRange}}</p>
                </div>

                <!-- <ng-container> -->

                <div class="year-result-container">

                    <!-- <div class="yearselectedlist" #myYearDiv>
                            <div class="year-range-selected-header"> 已选年段-Selected Year Range</div>
                            <p>{{displayYearRange}}</p>
                        </div> -->

                    <table>
                        <div *ngFor="let eachCheckedYear of checked_year_only">
                            <p>{{ eachCheckedYear }}</p>
                        </div>
                    </table>

                </div>



                <!-- </ng-container> -->

            </div>
        </div>

    </mat-card>

    <nav class="navbar fixed-bottom navbar-light bg-light" style="background-color: #e3f2fd;">
        <a class="navbar-brand" href="#">CCVG project PITT
            <img src="https://i.pinimg.com/originals/fe/fe/1b/fefe1b7d95c7a5ed3d707c6000b98a40.png" 
            alt="pittlogo"
            style="width: 30px;"
            >
        </a>
        <button mat-raised-button color="warn" (click)="resetAll()" 
        class="resetBtn"
        style="padding: 0%;"
        >
            重置所有筛选项 - Reset
          </button>

        <button mat-raised-button color="primary" class="multiSearch" (click)="goToPage()" class="searchBtn">
            搜索 - Search
          </button>
    </nav>

</div>


<!-- <button mat-raised-button color="warn" (click)="resetAll()" class="resetBtn">
  重置所有筛选项 - Reset
</button>

<button mat-raised-button class="multiSearch" (click)="goToPage()" class="searchBtn">
  搜索 - Search
</button> -->